// Code generated by protogen. DO NOT EDIT.

package bench

import (
	"fmt"

	"github.com/VictoriaMetrics/easyproto"
)

var _mp easyproto.MarshalerPool

// ProtobufMarshaler is the interface for types that can marshal to protobuf.
// Implement this interface to use custom types as nested messages.
type ProtobufMarshaler interface {
	MarshalProtobufTo(mm *easyproto.MessageMarshaler)
}

// ProtobufUnmarshaler is the interface for types that can unmarshal from protobuf.
// Implement this interface to use custom types as nested messages.
type ProtobufUnmarshaler interface {
	UnmarshalProtobuf(src []byte) error
}

// MarshalProtobuf marshals Message into protobuf message, appends this message to dst and returns the result.
func (x *Message) MarshalProtobuf(dst []byte) []byte {
	m := _mp.Get()
	x.MarshalProtobufTo(m.MessageMarshaler())
	dst = m.Marshal(dst)
	_mp.Put(m)
	return dst
}

// MarshalProtobufTo marshals Message fields to the given MessageMarshaler.
// Implements ProtobufMarshaler interface.
func (x *Message) MarshalProtobufTo(mm *easyproto.MessageMarshaler) {
	mm.AppendInt64(1, x.ID)
	mm.AppendString(2, x.Text)
	if x.Sender != nil {
		x.Sender.MarshalProtobufTo(mm.AppendMessage(3))
	}
	mm.AppendInt64(4, x.Timestamp)
	for _, v := range x.Tags {
		mm.AppendString(5, v)
	}
}

// UnmarshalProtobuf unmarshals Message from protobuf message at src.
func (x *Message) UnmarshalProtobuf(src []byte) (err error) {
	// Set default values
	x.ID = *new(int64)
	x.Text = *new(string)
	x.Sender = nil
	x.Timestamp = *new(int64)
	x.Tags = x.Tags[:0]

	// Parse message
	var fc easyproto.FieldContext
	for len(src) > 0 {
		src, err = fc.NextField(src)
		if err != nil {
			return fmt.Errorf("cannot read next field in Message: %w", err)
		}
		switch fc.FieldNum {
		case 1:
			v, ok := fc.Int64()
			if !ok {
				return fmt.Errorf("cannot read Message.ID")
			}
			x.ID = v
		case 2:
			v, ok := fc.String()
			if !ok {
				return fmt.Errorf("cannot read Message.Text")
			}
			x.Text = v
		case 3:
			data, ok := fc.MessageData()
			if !ok {
				return fmt.Errorf("cannot read Message.Sender data")
			}
			if x.Sender == nil {
				x.Sender = &User{}
			}
			if err := x.Sender.UnmarshalProtobuf(data); err != nil {
				return fmt.Errorf("cannot unmarshal Message.Sender: %w", err)
			}
		case 4:
			v, ok := fc.Int64()
			if !ok {
				return fmt.Errorf("cannot read Message.Timestamp")
			}
			x.Timestamp = v
		case 5:
			v, ok := fc.String()
			if !ok {
				return fmt.Errorf("cannot read Message.Tags")
			}
			x.Tags = append(x.Tags, v)
		}
	}
	return nil
}

// MarshalProtobuf marshals User into protobuf message, appends this message to dst and returns the result.
func (x *User) MarshalProtobuf(dst []byte) []byte {
	m := _mp.Get()
	x.MarshalProtobufTo(m.MessageMarshaler())
	dst = m.Marshal(dst)
	_mp.Put(m)
	return dst
}

// MarshalProtobufTo marshals User fields to the given MessageMarshaler.
// Implements ProtobufMarshaler interface.
func (x *User) MarshalProtobufTo(mm *easyproto.MessageMarshaler) {
	mm.AppendInt64(1, x.ID)
	mm.AppendString(2, x.Name)
	mm.AppendString(3, x.Email)
}

// UnmarshalProtobuf unmarshals User from protobuf message at src.
func (x *User) UnmarshalProtobuf(src []byte) (err error) {
	// Set default values
	x.ID = *new(int64)
	x.Name = *new(string)
	x.Email = *new(string)

	// Parse message
	var fc easyproto.FieldContext
	for len(src) > 0 {
		src, err = fc.NextField(src)
		if err != nil {
			return fmt.Errorf("cannot read next field in User: %w", err)
		}
		switch fc.FieldNum {
		case 1:
			v, ok := fc.Int64()
			if !ok {
				return fmt.Errorf("cannot read User.ID")
			}
			x.ID = v
		case 2:
			v, ok := fc.String()
			if !ok {
				return fmt.Errorf("cannot read User.Name")
			}
			x.Name = v
		case 3:
			v, ok := fc.String()
			if !ok {
				return fmt.Errorf("cannot read User.Email")
			}
			x.Email = v
		}
	}
	return nil
}
